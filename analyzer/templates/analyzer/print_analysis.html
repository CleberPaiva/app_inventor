<!DOCTYPE html>
{% load report_filters %}
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relat√≥rio de An√°lise - {{ aia_file.name }}</title>
    <style>
        /* Reset e configura√ß√µes b√°sicas */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Configura√ß√µes para impress√£o A4 */
        @page {
            size: A4;
            margin: 2cm;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            font-size: 12pt;
            margin: 0 30px;
            padding: 0;
        }

        /* Cabe√ßalho do relat√≥rio */
        .header {
            text-align: center;
            border-bottom: 2px solid #1976d2;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #1976d2;
            font-size: 24pt;
            margin-bottom: 10px;
        }

        .header .subtitle {
            color: #666;
            font-size: 14pt;
        }

        /* Informa√ß√µes do arquivo */
        .file-info {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
        }

        .file-info h2 {
            color: #1976d2;
            font-size: 16pt;
            margin-bottom: 10px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
        }

        .info-label {
            font-weight: bold;
            color: #555;
        }

        /* Scores principais */
        .scores-section {
            margin-bottom: 25px;
        }

        .scores-section h2 {
            color: #1976d2;
            font-size: 16pt;
            margin-bottom: 15px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }

        .score-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .score-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .score-value {
            font-size: 28pt;
            font-weight: bold;
            color: #1976d2;
            margin-bottom: 5px;
        }

        .score-label {
            color: #666;
            font-size: 11pt;
        }

        /* Distribui√ß√£o por qualidade */
        .quality-section {
            margin-bottom: 25px;
        }

        .quality-section h3 {
            color: #1976d2;
            font-size: 14pt;
            margin-bottom: 10px;
        }

        .quality-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .quality-item {
            padding: 10px;
            border-radius: 6px;
            text-align: center;
        }

        .quality-high {
            background-color: #e8f5e8;
            border: 1px solid #4caf50;
        }

        .quality-medium {
            background-color: #fff3e0;
            border: 1px solid #ff9800;
        }

        .quality-low {
            background-color: #ffebee;
            border: 1px solid #f44336;
        }

        /* Recomenda√ß√µes */
        .recommendations {
            margin-bottom: 25px;
        }

        .recommendations h3 {
            color: #1976d2;
            font-size: 14pt;
            margin-bottom: 10px;
        }

        .recommendation-item {
            background-color: #f8f9fa;
            padding: 10px;
            margin-bottom: 8px;
            border-left: 4px solid #1976d2;
            border-radius: 4px;
        }

        .recommendation-item::before {
            content: "‚Ä¢ ";
            color: #1976d2;
            font-weight: bold;
        }

        /* Estilos para relat√≥rio detalhado */
        .detailed-report {
            background-color: #fafafa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            font-size: 11pt;
            line-height: 1.6;
        }

        .detailed-report h1 {
            color: #1976d2;
            font-size: 16pt;
            margin-top: 20px;
            margin-bottom: 10px;
            border-bottom: 2px solid #1976d2;
            padding-bottom: 5px;
        }

        .detailed-report h2 {
            color: #1976d2;
            font-size: 14pt;
            margin-top: 15px;
            margin-bottom: 8px;
            border-bottom: 1px solid #ccc;
            padding-bottom: 3px;
        }

        .detailed-report h3 {
            color: #1976d2;
            font-size: 13pt;
            margin-top: 12px;
            margin-bottom: 6px;
        }

        .detailed-report h4 {
            color: #555;
            font-size: 12pt;
            margin-top: 10px;
            margin-bottom: 5px;
        }

        .detailed-report p {
            margin-bottom: 10px;
            text-align: justify;
        }

        .detailed-report strong {
            color: #333;
            font-weight: bold;
        }

        .detailed-report ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .detailed-report li {
            margin-bottom: 5px;
            list-style-type: disc;
        }

        .detailed-report hr.double-line {
            border: none;
            border-top: 2px solid #1976d2;
            margin: 20px 0;
        }

        .detailed-report hr.single-line {
            border: none;
            border-top: 1px solid #ccc;
            margin: 15px 0;
        }

        /* Formata√ß√£o para emojis e s√≠mbolos */
        .detailed-report .emoji {
            font-size: 14pt;
            margin-right: 5px;
        }

        /* Quebras de linha para se√ß√µes */
        .detailed-report .section {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dotted #ccc;
        }

        .detailed-report .section:last-child {
            border-bottom: none;
        }

        /* Rodap√© */
        .footer {
            margin-top: 30px;
            text-align: center;
            border-top: 1px solid #ddd;
            padding-top: 15px;
            color: #666;
            font-size: 10pt;
        }

        /* Quebras de p√°gina */
        .page-break {
            page-break-before: always;
        }

        /* Estilos para impress√£o */
        @media print {
            body {
                color: black !important;
            }
            
            .no-print {
                display: none !important;
            }
            
            /* Garantir que elementos n√£o sejam cortados */
            .file-info,
            .score-card,
            .quality-item,
            .recommendation-item {
                break-inside: avoid;
            }
        }

        /* Bot√£o de impress√£o (s√≥ aparece na tela) */
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #1976d2;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            z-index: 1000;
        }

        .print-button:hover {
            background-color: #1565c0;
        }

        @media print {
            .print-button {
                display: none;
            }
        }
    </style>
</head>
<body>
    <button class="print-button no-print" onclick="window.print()">
        üñ®Ô∏è Imprimir
    </button>

    <!-- Cabe√ßalho do Relat√≥rio -->
    <div class="header">
        <h1>Relat√≥rio de An√°lise de Usabilidade</h1>
        <div class="subtitle">MIT App Inventor - An√°lise de Qualidade de Interface</div>
    </div>

    <!-- Informa√ß√µes do Arquivo -->
    <div class="file-info">
        <h2>Informa√ß√µes do Projeto</h2>
        <div class="info-grid">
            <div class="info-item">
                <span class="info-label">Nome do Arquivo:</span>
                <span>{{ aia_file.name }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Tamanho:</span>
                <span>{{ aia_file.file_size_mb }} MB</span>
            </div>
            <div class="info-item">
                <span class="info-label">Data de Upload:</span>
                <span>{{ aia_file.uploaded_at|date:"d/m/Y H:i" }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Data da An√°lise:</span>
                <span>{{ evaluation.evaluated_at|date:"d/m/Y H:i" }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Total de Imagens:</span>
                <span>{{ total_images }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">Total de √çcones:</span>
                <span>{{ total_icons }}</span>
            </div>
        </div>
    </div>

    <!-- Scores Principais -->
    <div class="scores-section">
        <h2>Scores de Usabilidade</h2>
        <div class="score-grid">
            <div class="score-card">
                <div class="score-value">{{ evaluation.overall_usability_score|floatformat:1 }}%</div>
                <div class="score-label">Score Geral de Usabilidade</div>
            </div>
            <div class="score-card">
                <div class="score-value">{{ evaluation.image_quality_score|floatformat:1 }}%</div>
                <div class="score-label">Qualidade das Imagens</div>
            </div>
        </div>
    </div>

    <!-- Distribui√ß√£o por Qualidade -->
    <div class="quality-section">
        <h3>Distribui√ß√£o por Qualidade</h3>
        <div class="quality-grid">
            <div class="quality-item quality-high">
                <div style="font-size: 18pt; font-weight: bold;">{{ high_quality_count }}</div>
                <div>Alta Qualidade</div>
            </div>
            <div class="quality-item quality-medium">
                <div style="font-size: 18pt; font-weight: bold;">{{ medium_quality_count }}</div>
                <div>Qualidade M√©dia</div>
            </div>
            <div class="quality-item quality-low">
                <div style="font-size: 18pt; font-weight: bold;">{{ low_quality_count }}</div>
                <div>Baixa Qualidade</div>
            </div>
        </div>
    </div>

    <!-- Recomenda√ß√µes Detalhadas -->
    {% if detailed_recommendations %}
    <div class="recommendations">
        <h3>üìä Relat√≥rio Completo de An√°lise de Usabilidade</h3>
        <div class="detailed-report">
            {{ detailed_recommendations|format_report }}
        </div>
    </div>
    {% endif %}

    <!-- Detalhes T√©cnicos -->
    <div class="page-break">
        <h2 style="color: #1976d2; font-size: 16pt; margin-bottom: 15px; border-bottom: 1px solid #ddd; padding-bottom: 5px;">
            Detalhes T√©cnicos da An√°lise
        </h2>
        
        <div style="margin-bottom: 20px;">
            <h3 style="color: #1976d2; font-size: 14pt; margin-bottom: 10px;">Crit√©rios de Avalia√ß√£o</h3>
            <div style="background-color: #f8f9fa; padding: 15px; border-radius: 6px;">
                <p><strong>Resolu√ß√£o (40%):</strong> An√°lise da qualidade e adequa√ß√£o da resolu√ß√£o das imagens</p>
                <p><strong>Otimiza√ß√£o (30%):</strong> Efici√™ncia no uso de espa√ßo e compress√£o</p>
                <p><strong>Propor√ß√£o (20%):</strong> Adequa√ß√£o das propor√ß√µes para diferentes dispositivos</p>
                <p><strong>Material Design (10%):</strong> Conformidade com diretrizes do Material Design</p>
            </div>
        </div>

        {% if evaluation.total_issues > 0 %}
        <div style="background-color: #fff3e0; border: 1px solid #ff9800; padding: 15px; border-radius: 6px;">
            <h3 style="color: #f57c00; margin-bottom: 10px;">‚ö†Ô∏è Problemas Detectados</h3>
            <p><strong>{{ evaluation.total_issues }}</strong> problema(s) foram identificados na an√°lise que podem impactar a usabilidade do aplicativo.</p>
        </div>
        {% else %}
        <div style="background-color: #e8f5e8; border: 1px solid #4caf50; padding: 15px; border-radius: 6px;">
            <h3 style="color: #2e7d32; margin-bottom: 10px;">‚úÖ An√°lise Positiva</h3>
            <p>Nenhum problema cr√≠tico foi detectado na an√°lise. O projeto apresenta boa qualidade de usabilidade.</p>
        </div>
        {% endif %}
    </div>

    <!-- Rodap√© -->
    <div class="footer">
        <p>Relat√≥rio gerado automaticamente pelo Sistema de An√°lise de Apps .aia</p>
        <p>{{ "now"|date:"d/m/Y H:i" }} - Vers√£o do Sistema: 1.0</p>
    </div>
</body>
</html>
